import { formatDistanceToNow } from "date-fns"
import packageJson from "../../../package.json"
import themes from "../../../themes.json"

// JP Campos ASCII Art
const jpCamposArt = `
-------------------------------===-----------------=-====-======--------==+=------------------------
---------------------------===========----=-=-=-===-==-==================+=-------------------------
---------------------------=+========-===--=--=-=-=========+++=========+=---------------------------
-----------------------=++++===========-================================----------------------------
------------------==-=+*+======================+==============+========+=---------------------------
------------------=++**======================+=========+=======+========++=-------------------------
-------------------+#+==================+=============++==+======+=========+=-----------------------
----------------=+*#*+============+===++=============-:=+=+==================++#+-------------------
--------------=+###*+===========+===++++==========+=::::==+=+==============+=-----------------------
-----------=++***++====++=++=+======++===========+-:::::-==-==============+=+=----------------------
-----------=+++++========+=+++==++++=========++==-:::::::-=--==+====++====++=++---------------------
-----------+###*+++=============++=========++===---:::::::----==+===+#=====*===+*=------------------
---------=*######+===========++===========+*--=-:::::---::::::--+-===**====+=++++++=----------------
--=+##*########*+++===+=+*+++=+=+====+===++-:--:::::::::-==--::----====+===++++---------------------
---=+##########*#++++++=======++++++===+++-:::--==++==------==-:-:::-=-=+==+++*+--------------------
-----==+#########++++#+=========++===+==+-:-:-##+++*#%%#=--::::::::::-:-++=**+=#=-------------------
-------+#########+++*++=++=====+#+==+=-=-:::-:-::::+@@%==::::::::-:-----=+*##+-==-------------------
------+##########*+++++=+==----##+==-::-::-::::::::=%%%-:::::::::------==+#%#=----------------------
-----=*+*#########*++++==+=+++--+*==-:::::::::::-:---=+-::::::::::------=*%%%=----------------------
-----===*#########*+++++++++=++=-*+=:-:-::-:-:-::-:---:::::::::::=##%#--+%%=*+----------------------
-------=+##########+++**+---++++-=+=:::-:-::::::-:-:-:-::-:::::::.-%@%*=%*+-------------------------
-------=+##########++++*+--=+++---+-:-::::::-:-:::-::::-::-:::::-:=#%+-+==--------------------------
--------=+###########*+*++--++++--:-:--------------------::-:::-:------=----------------------------
---------=############**#+++--------:------------------------:-:------=-----------------------------
---------+*#############%**#%*----------------------------------------+-----------------------------
---------=+#############%%#%%%%*++=-----------------------------------=-----------------------------
---------=++*##############%%%%#*+*----------------------------------=------------------------------
------------=+*############@%%%%*+++--------------------------------==------------------------------
---------------+##########%@@%@%=++++=---------------=====---------==-------------------------------
----------------+#######%%#%%@%++-+++++---------------------=----===--------------------------------
----------------=*##########%@%----=+++++----------------==--====+=---------------------------------
----------------=+###########%@=-----++++**=---------------====+=-----------------------------------
----------------=**############=------=+++****=--------=======+-------------------------------------
---------------=+==+###########+---=---=+********+==-=-=====+=--------------------------------------
-------------------+*##########+---=-----+*******####+====+=----------------------------------------
--------------------=+########*+---=------=+**#***######+==-----------------+++=--------------------
---------------------=+#####+=#*=--==------=+*#*#######++=------------------------=====-------------
----------------------+###*==##*=--==---=-====+*#######+==-----------------------===-----====-------
----------------------+###+=****==--=---========+*##*++==+=----------------------++----====---------
--------------------+*###%+==##*======-=========+=======++##=-------------------+====++++++=+-------
-----------------=+####%@@+===*+=------=====++=======+++++#@@#=---------------=+---++=+=-=-=--------
-----------------+####@@@%======+=========+=========+++++*%@@@@#=-----------===--===+---------------
-----------------+#%@@@@@+======++=======+++=======++++++#@@@@@@@@*+=-------------------------------
---------------=#@@@@@@@@======+++=====++==++======+++++*@@@@@@@@@@@@@%#=---------------------------
`

const jpCamposTitle = `
     â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•
     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆ   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘         â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 â•šâ•â•â•â•â• â•šâ•â•          â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•     â•šâ•â•â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•`

const getPlatform = (): "Unknown" | "Windows" | "MacOS" | "Linux" => {
  let os: "Unknown" | "Windows" | "MacOS" | "Linux" = "Unknown"

  if (navigator.userAgent.indexOf("Win") != -1) {
    os = "Windows"
  }

  if (navigator.userAgent.indexOf("Mac") != -1) {
    os = "MacOS"
  }

  if (navigator.userAgent.indexOf("Linux") != -1) {
    os = "Linux"
  }

  return os
}

const getMainColor = () => {
  const platform = getPlatform()
  const themeName = localStorage.getItem("theme")
  const theme = themes.find((theme) => theme.name.toLowerCase() === themeName)

  if (!theme) {
    return "#00B4D8" // Celeste por defecto
  }

  return theme.cyan ?? "#00B4D8"
}

const getInfo = () => {
  const os = getPlatform()
  const themeName = localStorage.getItem("theme")
  const theme = themes.find((theme) => theme.name.toLowerCase() === themeName)
  const visitedAt = new Date(
    localStorage.getItem("visitedAt") || new Date().toString(),
  )

  const skills = [
    "React, Next.js, Astro, TypeScript",
    "Python, Node.js, FastAPI",
    "OpenAI, LangChain, RAG, LLMs",
    "N8N, Flowise, Automation",
    "PostgreSQL, MongoDB, Vector DBs",
  ]

  const quotes = [
    "Cualquier proceso que se repite es automatizable",
    "La IA es el futuro, y el futuro es ahora",
    "CÃ³digo limpio, soluciones brillantes",
    "Transformando ideas en realidad",
    "Fullstack Developer | AI Specialist",
  ]

  const mainColor = theme?.cyan ?? "#00B4D8"

  let message = ""
  message += `<span class="lyrartTitle">${jpCamposTitle}\n\n</span>`
  message += `<span class="lyrartTitle-mobile" style="color: ${mainColor}">âš¡ JP CAMPOS âš¡</span>\n`
  message += `<span style="color: ${mainColor}">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span>\n`
  message += `<span style="color: ${mainColor}">ğŸ‘¤ Name</span>: Jose Paul Campos Terrones\n`
  message += `<span style="color: ${mainColor}">ğŸ’¼ Role</span>: Fullstack Developer | AI Specialist\n`
  message += `<span style="color: ${mainColor}">ğŸ–¥ï¸ OS</span>: ${os}\n`
  message += `<span style="color: ${mainColor}">ğŸ¨ Theme</span>: ${themeName}\n`
  message += `<span style="color: ${mainColor}">ğŸ“¦ Version</span>: ${packageJson.version}\n`
  message += `<span style="color: ${mainColor}">â±ï¸ Uptime</span>: ${formatDistanceToNow(visitedAt)}\n`
  message += `<span style="color: ${mainColor}">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span>\n`
  message += `<span style="color: ${mainColor}">ğŸš€ Skills</span>:\n`
  skills.forEach(skill => {
    message += `   â€¢ ${skill}\n`
  })
  message += `<span style="color: ${mainColor}">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span>\n`
  message += `<span style="color: ${mainColor}">ğŸ’¬ Quote</span>: "${quotes[Math.floor(Math.random() * quotes.length)]}"\n`
  message += `<span style="color: ${mainColor}">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span>\n`
  message += `<span style="color: ${mainColor}">ğŸ”— Links</span>:\n`
  message += `   ğŸ“§ <a href="mailto:josepaulcamposterrones@gmail.com">josepaulcamposterrones@gmail.com</a>\n`
  message += `   ğŸ™ <a href="https://github.com/Akicoders" target="_blank">github.com/Akicoders</a>\n`
  message += `   ğŸ’¼ <a href="https://linkedin.com/in/paulct-dev" target="_blank">linkedin.com/in/paulct-dev</a>\n`
  message += `   ğŸ“· <a href="https://instagram.com/paul04_ct" target="_blank">instagram.com/paul04_ct</a>\n`

  return message
}

export const neofetch = async (args?: string[]): Promise<string> => {
  const info = getInfo()
  const themeName = localStorage.getItem("theme")
  const theme = themes.find((theme) => theme.name.toLowerCase() === themeName)
  const mainColor = theme?.cyan ?? "#00B4D8"

  return `
  <div class="neofetch-container">
    <table class="neofetch-table">
      <tr>
        <td class="lyrart" style="color: ${mainColor};">${jpCamposArt}</td>
        <td class="system">${info}</td>
      </tr>
    </table>
  </div>
  `
}
